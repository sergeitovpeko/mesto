(()=>{"use strict";class e{constructor(e,t,s,i){this._name=e,this._link=t,this._cardTemplate=s,this._handleCardClick=i}_getTemplate(){return this._cardTemplate.content.querySelector(".elements__list-item").cloneNode(!0)}createCard=()=>(this._element=this._getTemplate(),this._elementImage=this._element.querySelector(".elements__image"),this._elementTitle=this._element.querySelector(".elements__title"),this._buttonDelete=this._element.querySelector(".elements__button_delete"),this._buttonLike=this._element.querySelector(".elements__button_like"),this._setEventListeners(),this._elementImage.src=this._link,this._elementImage.alt=this._name,this._elementTitle.textContent=this._name,this._element);_setEventListeners(){this._buttonDelete.addEventListener("click",(()=>{this._handleDelete()})),this._buttonLike.addEventListener("click",(()=>{this._handleLike()})),this._elementImage.addEventListener("click",(()=>{this._handleCardClick(this._name,this._link)}))}_handleDelete(){this._element.remove()}_handleLike(){this._buttonLike.classList.toggle("elements__button_like_active")}}class t{constructor(e,t){this._formElement=t,this._inputList=Array.from(this._formElement.querySelectorAll(e.inputSelector)),this._submitButton=this._formElement.querySelector(e.submitSelector),this._inputSectionSelector=e.inputSectionSelector,this._inputErrorSelector=e.inputErrorSelector,this._inputErrorClass=e.inputErrorClass,this._disabledButtonClass=e.disabledButtonClass}_hiddenError=e=>{e.textContent="",e.classList.remove(this._inputErrorClass)};_showError=(e,t)=>{e.textContent=t,e.classList.add(this._inputErrorClass)};_toggleInputState=e=>{const t=e.closest(this._inputSectionSelector).querySelector(this._inputErrorSelector);e.validity.valid?this._hiddenError(t):this._showError(t,e.validationMessage)};_enableButton=()=>{this._submitButton.removeAttribute("disabled"),this._submitButton.classList.remove(this._disabledButtonClass)};disableButton=()=>{this._submitButton.setAttribute("disabled",!0),this._submitButton.classList.add(this._disabledButtonClass)};_toggleButtonState=()=>{this._inputList.every((e=>e.validity.valid))?this._enableButton():this.disableButton()};_setEventListeners=()=>{for(let e=0;e<this._inputList.length;e++){const t=this._inputList[e];t.addEventListener("input",(()=>{this._toggleInputState(t),this._toggleButtonState()}))}this._toggleButtonState()};enableValidation=()=>{this._setEventListeners()}}class s{constructor(e){this._popup=e,this._closeButton=this._popup.querySelector(".popup__close"),this._handleEscapeClose=this._handleEscapeClose.bind(this)}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscapeClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("click",this._handleEscapeClose)}_handleEscapeClose(e){"Escape"===e.key&&this.close()}_handleOverlayClose(e){e.target===e.currentTarget&&this.close()}setEventListeners(){this._closeButton.addEventListener("click",(()=>{this.close()})),this._popup.addEventListener("click",(e=>{this._handleOverlayClose(e)}))}}class i extends s{constructor(e){let{popupElement:t,submitForm:s}=e;super(t),this._submitForm=s,this._form=this._popup.querySelector(".popup__form"),this._inputsList=this._form.querySelectorAll(".popup__form-item")}_getInputValues(){return this._inputsValues={},this._inputsList.forEach((e=>{this._inputsValues[e.id]=e.value})),this._inputsValues}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._submitForm(this._getInputValues()),this.close()}))}close(){super.close(),this._form.reset()}}const n={formSelector:".popup__form",submitSelector:".popup__save",inputSelector:".popup__form-item",inputSectionSelector:".popup__form-input",inputErrorSelector:".popup__form-error",inputErrorClass:"popup__form-error_active",disabledButtonClass:"popup__save_inactive"},o=document.querySelector("#edit"),r=document.querySelector("#add"),l=document.querySelector("#image"),a=document.querySelector("#edit-form"),u=document.querySelector("#add-form"),_=document.querySelector(".profile__button_type-edit"),c=document.querySelector(".profile__button_type-add"),p=document.querySelector(".popup__form-item_input_name"),h=document.querySelector(".popup__form-item_input_job"),m=document.querySelector(".elements__list"),d=document.querySelector("#card-template"),f=new t(n,u);f.enableValidation(),new t(n,a).enableValidation();const b=new class extends s{constructor(e){super(e),this._bigImage=this._popup.querySelector(".popup__image"),this._nameImage=this._popup.querySelector(".popup__image-name")}open(e,t){super.open(),this._bigImage.src=t,this._bigImage.alt=e,this._nameImage.textContent=e}}(l);b.setEventListeners();const S=(e,t)=>{b.open(e,t)},v=t=>{const s=new e(t.name,t.link,d,S);E.addItem(s.createCard())},E=new class{constructor(e,t){let{items:s,renderer:i}=e;this._initialCards=s,this._renderer=i,this._container=t}renderItems(){this._initialCards.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:[{name:"Бурятия",link:"https://images.unsplash.com/photo-1665584567788-c9d06af61bf2?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1935&q=80"},{name:"Амурская область",link:"https://images.unsplash.com/photo-1631427513371-25728fe1feda?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1170&q=80"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Сахалин",link:"https://images.unsplash.com/photo-1661680390126-ed81efd300b5?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=688&q=80"},{name:"Хабаровск",link:"https://images.unsplash.com/photo-1581589375338-1adf221c67c1?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=735&q=80"},{name:"Владивосток",link:"https://images.unsplash.com/photo-1634545042913-fd935f23b144?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=735&q=80"}],renderer:v},m);E.renderItems();const g=new class{constructor(e){let{nameSelector:t,infoSelector:s}=e;this._name=document.querySelector(t),this._info=document.querySelector(s)}getUserInfo(){return{name:this._name.textContent,info:this._info.textContent}}setUserInfo(e){let{name:t,info:s}=e;this._name.textContent=t,this._info.textContent=s}}({nameSelector:".profile__name",infoSelector:".profile__job"}),y=new i({popupElement:o,submitForm:e=>{let{name:t,info:s}=e;g.setUserInfo({name:p.value,info:h.value}),y.close()}});y.setEventListeners(),_.addEventListener("click",(()=>{const{name:e,info:t}=g.getUserInfo();p.value=e,h.value=t,y.open()}));const x=new i({popupElement:r,submitForm:e=>{v(e),x.close(),f.disableButton()}});x.setEventListeners(),c.addEventListener("click",(()=>{x.open()})),new class{constructor(e){this.url=e.url,this.headers=e.headers}getResponse(){return fetch(this.url,{headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Ошибка: ${e.status}`)))}}({url:"https://mesto.nomoreparties.co/v1/cohort-64",headers:{authorization:"99359d1f-f5b1-4868-8efb-f0dafa2bda0d","Content-Type":"application/json"}}).getResponse()})();